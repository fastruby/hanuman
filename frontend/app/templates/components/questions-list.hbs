<div class="panel panel-info">
  <div class="panel-heading">
    <div class="panel-title">Survey Layout</div>
  </div>
  <div class="panel-body">
    {{#if isLoadingQuestions}}
      <div class="row">
        <div class="col-sm-12">
          <div class="progress-bar progress-bar-striped active notransition" role="progressbar" aria-valuenow="{{loadingProgress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{loadingProgress}}%;min-width: 2em;">
            {{loadingProgress}}%
          </div>
        </div>
      </div>
    {{else}}
    {{#if isSuperUser}}
      <div class="pull-right">
        <a class="btn btn-success" href="/hanuman/survey_templates/{{surveyTemplate.id}}/update_survey_data">
          <i class="glyphicons glyphicons-sort-by-order"></i>
          Resort Submitted Data
        </a>
      </div>
      <div class="clearfix"></div>
    {{/if}}

      <div class="row">
        <div class="col-sm-4"><strong>Label</strong></div>
        <div class="col-sm-2"><strong>Question Type</strong></div>
        <div class="col-sm-2"><strong>Info</strong></div>
        {{#if isSuperUser}}
          <div class="col-sm-2"><strong>Debug</strong></div>
        {{/if}}
        <div class="col-sm-4"></div>
      </div>

      <div class="row">
        <div class="col-sm-12">
          &nbsp;
        </div>
      </div>


      {{#sortable-group tagName="ul" class="sortable ui-sortable" onChange=(route-action "reorderQuestions") as |group|}}
        <!-- hardcode survey date row here -->
        <li class="li-question row question-border">
          <div class="row">
            <div class="col-sm-4" data-test="question.answerType.displayName">
              <span class="glyphicons glyphicons-sorting text-muted"></span>
              Survey Date
            </div>
            <div class="col-sm-2">Date</div>
            {{#if isSuperUser}}
              <div class="col-sm-6">
                <span class="label label-default">The Survey Date field is automatically added to all surveys and is always at the top of the Survey Layout</span>
              </div>
            {{else}}
              <div class="col-sm-4">
                <span class="label label-default">The Survey Date field is automatically added to all surveys and is always at the top of the Survey Layout</span>
              </div>
            {{/if}}
          </div>
        </li>
        {{#each sortedQuestions as |question|}}
          {{#sortable-item tagName="li" class="li-question row question-border item" model=question group=group handle=".glyphicons-sorting"}}
            {{#if question.supportAncestry}}
              {{#draggable-object-target action="setAncestry" acenstry=question dragOverAction='dragOver' dragOutAction='dragOut'}}
                {{question-row question=question deleteQuestion='deleteQuestion' isFullyEditable=isFullyEditable ancestrable=true}}
              {{/draggable-object-target}}
            {{else}}
              {{#draggable-object content=question dragStartAction='dragStarted' dragEndAction='dragEnded' dragHandle='.glyphicons-move-square'}}
                {{question-row question=question deleteQuestion='deleteQuestion' isFullyEditable=isFullyEditable}}
              {{/draggable-object}}
            {{/if}}
          {{/sortable-item}}
        {{/each}}
      {{/sortable-group}}

      {{!-- Add new question --}}
      <ul class="sortable ui-sortable ember-view">
        {{#link-to "survey_templates.record.questions.new"}}
          <li class="li-question row question-border question-border-add-row item">
            <span class="glyphicons glyphicons-plus-sign"></span>
            Add Question
          </li>
        {{/link-to}}
      </ul>
    {{/if}}
  </div>
</div>
